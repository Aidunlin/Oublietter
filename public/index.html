<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Oublietter (WIP)</title>

  <script defer src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/8.0.0/firebase-auth.js"></script>
  <!-- Initialize Firebase with config object -->
  <script defer src="./firebase-init.js"></script>

  <style>
    * {
      font-family: sans-serif;
    }
    #signin, #signout {
      display: none;
    }
  </style>
</head>

<body>
  <h1>Oublietter (WIP)</h1>
  <p>A dungeon creator web app in early development.</p>
  <p>Below is a super-basic Google sign in/out system.</p>

  <button id="signin">Sign in</button>
  <button id="signout">Sign out</button>

  <p id="output"></p>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      firebase.auth().onAuthStateChanged(user => {
        if (user) {
          document.getElementById("output").innerHTML = user.displayName;
          document.getElementById("signin").style.display = "none";
          document.getElementById("signout").style.display = "inline";
        } else {
          document.getElementById("output").innerHTML = "Not signed in";
          document.getElementById("signin").style.display = "inline";
          document.getElementById("signout").style.display = "none";
        }
      });

      document.getElementById("signin").onclick = () => {
        let provider = new firebase.auth.GoogleAuthProvider();
        firebase.auth().signInWithPopup(provider).then(result => {
          let token = result.credential.accessToken;
          let user = result.user;
        }).catch(error => {
          document.getElementById("output").innerHTML = JSON.stringify(error);
        });
      };

      document.getElementById("signout").onclick = () => {
        firebase.auth().signOut().catch(error => {
          document.getElementById("output").innerHTML = "Error occured";
        });
      };
    });
  </script>
</body>

</html>